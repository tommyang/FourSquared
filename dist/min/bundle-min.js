"use strict";function initRunCallback(e,o,t){e.$on("$stateChangeSuccess",function(n,r,i,l,a){t.debugMode||e.admin_id||"signin"!=r.name&&"register"!=r.name&&o.go("signin"),t.isMobile&&0==r.mobile&&o.go("checkin")})}function ionicCallback(e){e?angular.module("robobetty").run(["$rootScope","$state","appConfig","$ionicPlatform",function(e,o,t,n){n.ready(function(){return window.StatusBar?StatusBar.hide():void initRunCallback(e,o,t)})}]):angular.module("robobetty").run(["$rootScope","$state","appConfig",function(e,o,t){initRunCallback(e,o,t)}])}function appendIonic(e){return IS_MOBILE&&e.push("ionic"),e}function DeleteModalInstanceCtrl(e){var o=this;o.ok=function(){console.log("Deleted field"),e.close()},o.cancel=function(){e.dismiss("cancel")}}function ModalInstanceCtrl(e){var o=this;o.title="Error",o.body="No fields added yet, please add fields to the form before preview.",o.btns=[{result:"ok",label:"OK",cssClass:"btn-primary btn"}],o.ok=function(){console.log("hey"),e.close()}}angular.module("robobetty",appendIonic(["ui.router","widget","product","dashboard","ui.bootstrap","signin","register","thankyou","DashboardFormBuilderModule","checkin","thankyouCheckIn","recovery","recoverythx","themes"])).config(function(e,o){o.otherwise("/patientQueue"),e.state("common",{templateUrl:"views/components/dashboard/main/views/dashboard.html","abstract":!0,mobile:!1}).state("home",{url:"/home",templateUrl:"views/components/home/views/home.html",mobile:!1}).state("createForm",{url:"/createform",controller:"FormCreateController",templateUrl:"views/components/dashboard/formBuilder/views/create.html",parent:"common",title:"Create New Form",mobile:!1}).state("dashboard",{url:"/dashboard",template:"",parent:"common",title:"",mobile:!1}).state("patientQueue",{url:"/patientQueue",templateUrl:"views/components/dashboard/patientQueue/views/patients.html",parent:"common",title:"Patients Queue",mobile:!1}).state("employees",{url:"/employees",templateUrl:"views/components/dashboard/employees/views/employees.html",parent:"common",title:"Employees",mobile:!1}).state("signin",{url:"/signin",templateUrl:"views/components/receptionistPortal/signin/views/login.html",mobile:!0}).state("register",{url:"/register",templateUrl:"views/components/receptionistPortal/register/views/register.html",mobile:!0}).state("checkin",{url:"/checkin",templateUrl:"views/components/patientCheckin/checkin/views/checkin.html",mobile:!0}).state("thankyou",{url:"/thankyou",templateUrl:"views/components/receptionistPortal/register/views/thankyou.html",mobile:!0}).state("thankyouCheckIn",{url:"/thankyouCheckIn",templateUrl:"views/components/patientCheckin/checkin/views/CheckInthankyou.html",mobile:!0}).state("recovery",{url:"/recovery",controller:"RecoveryController",templateUrl:"views/components/receptionistPortal/recovery/views/recovery.html",mobile:!0}).state("recoverythx",{url:"/recoverythx",controller:"RecoveryConfirmController",templateUrl:"views/components/receptionistPortal/recovery/views/recoveryconfirm.html",mobile:!1}).state("themes",{url:"/themes",parent:"common",title:"Themes",templateUrl:"views/components/dashboard/themes/views/dashboardIndex.html",mobile:!1}).state("settings",{url:"/settings",parent:"common",title:"Settings",templateUrl:"views/components/dashboard/settings/views/settings.html",mobile:!1})}),ionicCallback(IS_MOBILE),angular.module("auth",[]),angular.module("widget",[]),angular.module("dashboard",["ngCookies","smart-table","ui.bootstrap","ui.mask"]),angular.module("product",[]),angular.module("settings",[]),angular.module("themes",[]),angular.module("checkin",["auth"]),angular.module("thankyouCheckIn",[]),angular.module("recovery",[]),angular.module("recoverythx",[]),angular.module("register",["auth"]),angular.module("thankyou",[]),angular.module("signin",["auth"]),angular.module("theme",[]),angular.module("robobetty").constant("appConfig",{isMobile:IS_MOBILE||!1,baseUrl:"https://blue-jay.herokuapp.com/",debugMode:!1}),angular.module("robobetty").constant("BACKEND_NAMESPACE",["api","auth","socket.io"]);var IS_MOBILE=!0;angular.module("robobetty").config(["$httpProvider",function(e){e.interceptors.push("middleware")}]).factory("middleware",function(e,o){return{request:function(t){if(e.isMobile){var n=!1;0==t.url.indexOf("/")&&(t.url=t.url.slice(1));for(var r=0;r<o.length;r++)0==t.url.indexOf(o[r])&&(e.debugMode&&console.log(o[r]+" "+t.url),n=!0);n&&(t.url=e.baseUrl+t.url)}return t}}}),angular.module("auth").factory("TokenInjector",function(){function e(e){n=e}function o(){return n}function t(e){return n&&(e.headers.token=n),e}var n,r={request:t,getToken:o,setToken:e};return r}).config(["$httpProvider",function(e){e.interceptors.push("TokenInjector")}]),angular.module("auth").service("AuthService",["TokenInjector","$http",function(e,o){this.signin=function t(n){function r(o){o&&o.token&&e.setToken(o.token)}function i(o){e.setToken(void 0)}var l=n;return console.log(l),o.post("/auth/login",l).success(r).error(i)},this.reg=function n(t){function n(o){o&&o.token&&e.setToken(o.token)}function r(o){e.setToken(void 0).success(n).error(r)}var i=t;return console.log(i),o.post("/auth/signup",i)}}]),angular.module("widget").directive("navBar",function e(){return{restrict:"E",templateUrl:"views/shared/widget/views/header-bar.html"}}),angular.module("product").controller("ProductController",["ProductService",function(e){var o=this;o.products=[],e.getProducts().success(function(e){o.products=e}).error(function(e){console.log("There was an error: "+e)})}]),angular.module("product").directive("productDescription",function(){return{restrict:"E",templateUrl:"views/components/product/views/product-description.html"}}),angular.module("product").directive("productGallery",function(){return{restrict:"E",templateUrl:"views/components/product/views/product-gallery.html ",controller:"GalleryController",controllerAs:"galleryCtrl"}}).controller("GalleryController",function(){this.current=0,this.setCurrent=function(e){this.current=e||0}}),angular.module("product").directive("productReviews",function(){return{restrict:"E",templateUrl:"views/components/product/views/product-reviews.html",controller:"ReviewController",controllerAs:"reviewCtrl"}}).controller("ReviewController",function(){this.review={},this.review.createdOn=Date.now(),this.addReview=function e(o){o.reviews.push(this.review),this.review={}}}),angular.module("product").directive("productSpecs",function(){return{restrict:"E",templateUrl:"views/components/product/views/product-specs.html"}}),angular.module("product").directive("productTabs",function(){return{restrict:"E",templateUrl:"views/components/product/views/product-tabs.html",controller:"TabController",controllerAs:"tabCtrl"}}).controller("TabController",function(){this.tab=1,this.setTab=function(e){this.tab=e},this.isSet=function(e){return this.tab===e}}),angular.module("product").service("ProductService",["$http",function(e){this.getProducts=function(){return e.get("https://blue-jay.herokuapp.com/api/products")}}]),angular.module("dashboard").controller("EmployeeModalController",function(e,o){e.ok=function(){o.close(e.modal)},e.cancel=function(){o.dismiss("cancel")}}),angular.module("dashboard").controller("EmployeeRemoveController",function(e,o,t){e.selectedPatient=t,e.ok=function(){o.close(e.selectedPatient)},e.cancel=function(){o.dismiss("cancel")}}),angular.module("dashboard").controller("EmployeeRemoveMultipleController",function(e,o,t){e.selectedEmployees=t,e.ok=function(){o.close(e.selectedEmployees)},e.cancel=function(){o.dismiss("cancel")}}),angular.module("dashboard").directive("employees",function(){return{restrict:"E",templateUrl:"views/components/dashboard/employees/views/employees.html",controller:"EmployeeController",controllerAs:"employeeCtrl"}}).controller("EmployeeController",["$scope","$window","$modal","filterFilter","$http","$rootScope",function(e,o,t,n,r,i){e.rowCollection=[],e.getEmployees=function(){r.get("/api/employee/admin/"+i.admin_id).success(function(o){return null===o?[]:(o.forEach(function(o){console.log(o),e.rowCollection.push({id:o._id,Name:o.name,PhoneNumber:o.phone_number,Email:o.email})}),o)}).error(function(e){console.log(e)})},e.getEmployees(),console.log(e.rowCollection),console.log("getting type"),console.log(typeof e.rowCollection),$("#toaster").hide();var l=1;e.newField={},e.editing=!1,e.displayedCollection=[].concat(e.rowCollection),e.checkIfEmptyTable=function(){return 0===e.displayedCollection.length},e.editRowCollection=function(o){e.editing=e.rowCollection.indexOf(o),e.newField=angular.copy(o);var t=o.PhoneNumber;-1==o.PhoneNumber.indexOf("(")&&(o.PhoneNumber="("+t.substring(0,3)+") "+t.substring(3,6)+"-"+t.substring(6,10))},e.cancel=function(o){e.rowCollection[e.editing]=e.newField,e.displayedCollection=e.rowCollection},e.removeEmployee=function(o){var n=t.open({templateUrl:"views/components/dashboard/employees/views/employee-remove.html",controller:"EmployeeRemoveController",size:"md",backdrop:!0,resolve:{item:function(){return e.selectedPatient=o,e.selectedPatient}}}).result.then(function(o){e.row=o;var t=e.rowCollection.indexOf(e.row);-1!==t&&(e.rowCollection.splice(t,1),e.row={})})},e.removeMultiple=function(o){var n=t.open({templateUrl:"views/components/dashboard/employees/views/employee-remove-multiple.html",controller:"EmployeeRemoveMultipleController",size:"md",backdrop:!0,resolve:{item:function(){return e.selectedEmployees=o,e.selectedEmployees}}}).result.then(function(o){e.selectedEmployees=o,e.removeMultipleFinal(e.selectedEmployees)})},e.removeMultipleFinal=function(o){e.rowCollection=n(e.rowCollection,function(e){return e.selected&&r["delete"]("/api/employee/"+e.id).success(function(e,o,t,n){console.log("Removed id",e)}).error(function(o,t,n,l){console.log("Could not remove employee id.",o),console.log("Trying to remove from database by email"),r.get("/api/employee/admin/"+i.admin_id).success(function(o,t,n,i){for(var l=0;l<o.length;l++)e.Email==o[l].email&&(console.log("Found! Removing ",e.Email),r["delete"]("/api/employee/"+o[l]._id).success(function(e,o,t,n){console.log("Removed id",e)}).error(function(e,o,t,n){console.log("Completely failed to remove employee",e)}))}).error(function(e,o,t,n){console.log("Could not retrieve and remove emlpoyees",e)})}),!e.selected})},e.submitForm=function(o){e.rowCollection.unshift(o),e.row={},e.addForm.name.$setPristine(),e.addForm.number.$setPristine(),e.addForm.email.$setPristine()},e.openModal=function(){var o=t.open({templateUrl:"views/components/dashboard/employees/views/employees-modal.html",controller:"EmployeeModalController",size:"md",backdrop:!0,resolve:{}}).result.then(function(o){var t=o.PhoneNumber;e.rowCollection.unshift(o={Name:o.Name,PhoneNumber:"("+t.substring(0,3)+") "+t.substring(3,6)+"-"+t.substring(6,10),Email:o.Email}),$("#toaster").fadeIn(),setTimeout(function(){$("#toaster").fadeOut()},2e3),r.post("/api/employee",{_admin_id:i.admin_id,name:o.Name,email:o.Email,phone_number:t}).success(function(o,t,n,r){console.log("Employee Added",o),e.rowCollection[e.rowCollection.length-1].id=o._id}).error(function(e,o,t,n){console.log("Employee failed to add",e,o,t)})})}}]);var angularApp=angular.module("DashboardFormBuilderModule",["ui.bootstrap"]);angular.module("dashboard").controller("DashboardController",["$scope","$rootScope","$state",function(e,o,t){e.title=t.current.title,o.$on("$stateChangeStart",function(o,t,n,r,i){e.title=t.title})}]),angular.module("dashboard").controller("PatientModalController",function(e,o,t){e.selectedPatient=t,e.ok=function(t){e.selectedPatient.Name=e.name,e.selectedPatient.Doctor=e.doctor,o.close()},e.cancel=function(){o.dismiss("cancel")}}),angular.module("dashboard").controller("PatientRemoveController",function(e,o,t){e.selectedPatient=t,e.ok=function(t){o.close(e.selectedPatient)},e.cancel=function(){o.dismiss("cancel")}}),angular.module("dashboard").controller("PatientQueueCtrl",["$scope","$modal","$rootScope","socket","DoctorService",function(e,o,t,n,r){var i=new Date,l=6e4;e.rowCollection=new Array,e.patientqueue;var a=20;n.emit("request_queue",t.admin_id),n.on("request_id",function(){console.log("on request_id",t.admin_id),t.admin_id?(console.log(t.admin_id),n.emit("_admin_id",{_admin_id:t.admin_id})):console.log("Socket cannot connect. No AdminId Found.")}),n.on("queue_updated",function(o){console.log("queue updated received",o),e.rowCollection=[],e.patientqueue=o;var t=0;t=null==o.patients?o.length:o.patients.length,console.log("patient length",t);var n=0;for(n=0;t>n;n++)e.rowCollection.push({id:o.patients[n]._id,Name:o.patients[n].name,Doctor:r.getRandomDoctor(),Time:new Date(new Date(o.patients[n].checkin_time).valueOf()).toLocaleTimeString().replace(/:\d+ /," "),TimeValue:new Date(o.patients[n].checkin_time).valueOf()});console.log("rowCollection",e.rowCollection),e.displayedCollection=e.rowCollection}),e.displayedCollection=[].concat(e.rowCollection),e.checkIfLongWait=function(e){var o=(new Date).valueOf();return o-e>=l*a},e.checkIfEmptyTable=function(){return 0===e.displayedCollection.length},e.removeItem=function(r){var i=o.open({templateUrl:"views/components/dashboard/patientQueue/views/patient-remove.html",controller:"PatientRemoveController",size:"md",backdrop:!0,resolve:{item:function(){return e.selectedPatient=r,e.selectedPatient}}}).result.then(function(o){e.row=o;var r=e.rowCollection.indexOf(e.row);if(-1!==r){var i=e.rowCollection[r].Name;console.log(i),e.rowCollection.splice(r,1);var l=[],a=e.rowCollection.length,s=0;for(s=0;a>s;s++)l.push({_admin_id:t.admin_id,_id:e.rowCollection[s].id,checkin_time:e.rowCollection[s].TimeValue,name:e.rowCollection[s].Name})}e.patientqueue.patients=l,n.emit("patient_removed",{queue:e.patientqueue,patientName:i})})}}]),angular.module("dashboard").factory("socket",function(e){if(IS_MOBILE)var o=io.connect("https://blue-jay.herokuapp.com");else var o=io.connect();return{on:function(t,n){o.on(t,function(){var t=arguments;e.$apply(function(){n.apply(o,t)})})},emit:function(t,n,r){o.emit(t,n,function(){var t=arguments;e.$apply(function(){r&&r.apply(o,t)})})}}}),angular.module("dashboard").service("DoctorService",[function(){var e=[{doctor:"Phil"},{doctor:"Powell"},{doctor:"Soe"},{doctor:"Pepper"},{doctor:"Kanye"},{doctor:"Ly"},{doctor:"Douglas"},{doctor:"Chen"},{doctor:"West"}];this.getAllDoctors=function(){return e},this.getRandomDoctor=function(){return e[Math.floor(Math.random()*e.length)].doctor}}]),angular.module("dashboard").controller("SettingsController",["$scope","$rootScope","SettingsService",function(e,o,t){e.user={password:""},e.alerts=[],e.newpassword="",e.newemail="",e.new_company_name="",e.new_company_phone_number="",e.validateNewPass="",e.email=o.email,e.update=function(){if(e.updateClicked=!0,e.alerts.pop(),""==e.user.password)e.alerts.push({type:"danger",msg:"You must supply your current password."});else{if(""==e.newpassword&&""==e.newemail&&""==e.new_company_name&&""==e.new_company_phone_number)return void e.alerts.push({type:"warning",msg:"Settings were not changed"});if(e.validateNewPass!=e.newpassword)return void e.alerts.push({type:"danger",msg:"New password and Confirmation are not the same."});if(e.newpassword.length<4)return void e.alerts.push({type:"danger",msg:"New Password length must be at least 4 characters."});""!=e.newpassword&&(e.user.newpassword=e.newpassword),""!=e.newemail&&(e.user.newemail=e.newemail),""!=e.new_company_name&&(e.user.new_company_name=e.new_company_name),""!=e.new_company_phone_number&&(e.user.new_company_phone_number=e.new_company_phone_number),t.update(e.user).success(function(t){return"Oops! Wrong password"==t?e.alerts.push({type:"danger",msg:"Oops! Please check your password!"}):(""!=e.newemail&&(o.email=e.newemail),e.alerts.push({type:"success",msg:"You have successfully changed your settings"})),t}).error(function(o){return e.alerts.push({type:"danger",msg:"Settings change not successful"}),o})}}}]),angular.module("dashboard").service("SettingsService",["$http","$rootScope",function(e,o){this.update=function(t){return e.put("/auth/setting/"+o.email,t)}}]),angular.module("dashboard").directive("sideBar",function(){return{restrict:"E",templateUrl:"views/components/dashboard/sidebar/views/side-bar.html",controller:"SidebarController",controllerAs:"sidebarCtrl"}}).controller("SidebarController",["$scope","$rootScope","$cookieStore","SidebarService",function(e,o,t,n){var r=992;e.company_name=o.company_name,e.email=o.email,e.options=n.getSidebarOptions(),e.sidebarHeader=n.getSidebarHeader(),e.getWidth=function(){return window.innerWidth},e.$watch(e.getWidth,function(o,n){o>=r?angular.isDefined(t.get("toggle"))?e.toggle=t.get("toggle")?!0:!1:e.toggle=!0:e.toggle=!1}),e.toggleSidebar=function(){e.toggle=!e.toggle,t.put("toggle",e.toggle)},window.onresize=function(){e.$apply()}}]),angular.module("dashboard").service("SidebarService",[function(){this.getSidebarOptions=function(){return[{option:"Patients",icon:"menu-icon fa fa-users",link:"patientQueue"},{option:"Employees",icon:"menu-icon fa fa-user",link:"employees"},{option:"Forms",icon:"menu-icon fa fa-check-square-o",link:"createform"},{option:"Themes",icon:"menu-icon fa fa-picture-o",link:"themes"},{option:"Settings",icon:"menu-icon fa fa-cog",link:"settings"}]},this.getSidebarHeader=function(){return"iReceptionist"}}]),angular.module("dashboard").controller("ThemesController",["$scope","$location","$rootScope","ThemesService",function(e,o,t,n){function r(e,o){for(var t=[],n=0;n<e.length;n+=o)t.push(e.slice(n,n+o));return t}e.message="",e.theme={form_color:"default",background_img:"default",displayPhone:!0,diplayClock:!0,displaySignature:!0,additionalComments:!0},e.img=["images/themes/pink_trees.jpg","images/themes/city0.jpg","images/themes/city1.jpg","images/themes/city2.png","images/themes/city3.jpg","images/themes/colors.jpg","images/themes/flamingo1.jpg","images/themes/flamingo2.jpg","images/themes/lake.jpg","images/themes/maverick.png","images/themes/old-fashioned.jpg","images/themes/tron.jpg","images/themes/walkway.jpg"],e.splitData=r(e.img,3),e.selectedImage={value:""},e.submitTheme=function(){e.theme.background_img=e.img[e.selectedImage.value],console.log("BKGD : "+e.selectedImage.value);var o=!1;n.read().success(function(o){return console.log("currently has"),console.log(o),"null"==o&&n.create(e.theme).success(function(e){console.log("create"),console.log(e)}).error(function(o){e.message="Error selecting theme.",console.log("Theme selction failed.")}),""!==e.selectedImage.value?n.update(e.theme).success(function(o){console.log("updated"),console.log(o),e.message="Theme updated successfully!"}).error(function(o){e.message="Error selecting theme.",console.log("Theme selction failed.")}):e.message="Please select an image first.",o}).error(function(e){return console.log("Theme selction failed."),e})},e.clear=function(){e.theme.background_img="",e.selectedImage.value="",e.message=""}}]),angular.module("themes").service("ThemesService",["$http","$rootScope",function(e,o){var t=o.admin_id;this.read=function(){return e.get("/api/"+o.admin_id+"/theme")},this.update=function(n){return console.log("Sending the update req to: "+t),e.put("/api/"+o.admin_id+"/theme",n)},this.create=function(t){return console.log("Create"),e.post("/api/"+o.admin_id+"/theme",t)},this["delete"]=function(){}}]),angular.module("checkin").controller("CheckinController",["$scope","$rootScope","$timeout","$location","CheckinService","appConfig",function(e,o,t,n,r,i){e.appConfig=i,e.clock="loading clock...",e.tickInterval=1e3,e.user={email:o.email,password:""},e.background_image;var l=function(){e.clock=Date.now(),t(l,e.tickInterval)};e.init=function(){r.getTheme(o.admin_id).success(function(o){return"null"==o||"default"==o.background_img?e.background_image="images/themes/city0.jpg":e.background_image=o.background_img,o}).error(function(e){return e}),r.getForms(o.admin_id).success(function(o){return o.template.submitted=!1,e.form=o.template,o}).error(function(e){return e})},t(l,e.tickInterval)}]),angular.module("checkin").controller("admin_signinCtrl",["$scope","$rootScope","$location","AuthService","CheckinService",function(e,o,t,n,r){e.user={email:o.email,password:""},e.errMessage="",e.checkin=function(){if(-1==o.email.indexOf("@")||-1==o.email.indexOf("."))e.errMessage="Invalid Email/Password";else{var i=this;n.signin(e.user).success(function(n){return"Oops! Wrong password"!=n?(o.token=n.token,o.email=e.user.email,r.closeModal(),t.path("../../../dashboard/views/dashboard.html"),n):void(e.errMessage="Invalid Email/Password")}).error(function(o){return e.errMessage="Invalid Email/Password",o})}}}]),angular.module("checkin").controller("ModalDemoCtrl",["$scope","$modal","$log","CheckinService",function(e,o,t,n){e.items=["item1","item2","item3"],e.open=function(r){var i=o.open({templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:r,resolve:{items:function(){return e.items}}});n.setModal(i),i.result.then(function(o){e.selected=o},function(){t.info("Modal dismissed at: "+new Date)})}}]),angular.module("thankyouCheckIn").controller("CheckInThankYouController",["$location","$timeout",function(e,o){function t(){e.path("/checkin")}o(t,5e3)}]),angular.module("checkin").directive("patientFormDirective",function(){return{controller:function(e,o,t,n){function r(){console.log("redirecttoCheckin"),e.form.submitted=!1,e.form.form_fields.forEach(function(e){e.field_value=""})}e.submit=function(){e.form.submitted=!0;for(var t=0;t<e.form.form_fields.length;t++)e.form.form_fields[t].field_readonly=!1,console.log(e.form.form_fields);o.formData.data=e.form.form_fields,o.formData.submitted=!0,o.submitForm(o.formData),o.checkinPatient(e.form.form_fields[0].field_value),n(r,5e3)}},templateUrl:"views/components/patientCheckin/checkin/views/directive-templates/form/form.html",restrict:"E",scope:{form:"="}}}),angular.module("checkin").service("CheckinService",["$http","$rootScope","socket",function o(e,t,n){var r="";this.getTheme=function(o){console.log(o),console.log("getThemes");var t="/api/"+o+"/theme";return console.log(t),e.get("/api/"+o+"/theme")},this.getForms=function(o){console.log(o),console.log("getForms");var t="/api/form/template/company/"+o;return console.log(t),e.get(t)},this.formData={},this.submitForm=function(o){return e.post("api/form/patient/",{_admin_id:t.admin_id,form:o})},this.checkinPatient=function(o){console.log(o),e.post("/api/patient/checkin",{_admin_id:t.admin_id,name:o}).success(function(e,o,t,r){console.log("checkinsuccess",e),n.emit("patient_added",{patients:e.queue.patients})}).error(function(e,o,t,n){console.log("error",e,o,t)})},this.setModal=function(e){r=e},this.closeModal=function(){""!=r?r.dismiss("cancel"):console.log("Error, modal not set")}}]),angular.module("recovery").controller("RecoveryController",["$scope","$location","RecoveryService",function(e,o,t){e.email="",e.errMessage="",e.recovery=function(){""==e.email?e.errMessage="You must enter a valid email address.":-1==e.email.indexOf("@")||-1==e.email.indexOf(".")?e.errMessage="Invalid Email/Password":t.recover(e.email).success(function(t){return e.errMessage="Recover password successful.",o.path("/registerthx"),t}).error(function(o){return console.log("Recover password failed."),e.errMessage="Recover password failed.",o})}}]),angular.module("recoverythx").controller("RecoveryConfirmController",["$location","$timeout",function(e,o){function t(){e.path("/signin")}o(t,3e3)}]),angular.module("recovery").service("RecoveryService",["$http",function(e){this.recover=function(e){}}]),angular.module("register").controller("RegisterController",["$scope","$rootScope","$location","AuthService",function(e,o,t,n){e.user={email:"",password:"",company_name:"",company_phone_number:""},e.number="",e.pass="",e.err=!1,e.check=!1,e.errorMessage="",e.reg=function(){if(e.user.company_phone_number="",null!=e.number&&(console.log(typeof e.user.company_phone_number),e.user.company_phone_number=e.number.toString()),""==e.user.email||""==e.user.password||""==e.user.company_name||""==e.user.company_phone_number)e.errorMessage="Please provide company name, password, phone, and email.";else{if(e.pass!=e.user.password)return void(e.errorMessage="Please make sure your passwords match");if(e.pass.length<4)return void(e.errorMessage="Password must be at least 4 characters");if(10!=e.user.company_phone_number.length&&11!=e.user.company_phone_number.length)return void(e.errorMessage="Phone number should be 10-11 numbers long.");if(!e.check)return void(e.errorMessage="You must agree to the terms and conditions");n.reg(e.user).success(function(n){return o.token=n.token,o.number=n.company_phone_number,o.company_name=n.company_name,o.admin_id=n.admin_id,o.email=e.user.email,t.path("/thankyou"),n}).error(function(o){return e.errorMessage="You have already created an account",o})}}}]),angular.module("thankyou").controller("ThankYouController",["$location","$timeout",function(e,o){function t(){e.path("../../../dashboard/views/dashboard.html")}o(t,3e3)}]),angular.module("register").directive("checkStrength",function(){return{replace:!1,restrict:"EACM",link:function(e,o,t){var n={colors:["#F00","#F90","#FF0","#9F0","#0F0"],mesureStrength:function(e){var o=0,t=/[$-/:-?{-~!"^_`\[\]]/g,n=/[a-z]+/.test(e),r=/[A-Z]+/.test(e),i=/[0-9]+/.test(e),l=t.test(e),a=[n,r,i,l],s=$.grep(a,function(e){return e===!0}).length;return o+=2*e.length+(e.length>=10?1:0),o+=10*s,o=e.length<=6?Math.min(o,10):o,o=1==s?Math.min(o,10):o,o=2==s?Math.min(o,20):o,o=3==s?Math.min(o,40):o},getColor:function(e){var o=0;return o=10>=e?0:20>=e?1:30>=e?2:40>=e?3:4,{idx:o+1,col:this.colors[o]}}};e.$watch(t.checkStrength,function(){if(""===e.user.password)o.css({display:"none"});else{var t=n.getColor(n.mesureStrength(e.user.password));o.css({display:"inline"}),o.children("li").css({background:"#DDD"}).slice(0,t.idx).css({background:t.col})}})},template:'<li class="point"></li><li class="point"></li><li class="point"></li><li class="point"></li><li class="point"></li>'}}),angular.module("register").service("RegisterService",["$http",function(e){this.reg=function(o){return e.post("/auth/signup",o)}}]),angular.module("signin").controller("SigninController",["$scope","$rootScope","$location","AuthService","socket","appConfig",function(e,o,t,n,r,i){e.user={email:"",password:""},e.errMessage="",e.appConfig=i,e.login=function(){if(-1==e.user.email.indexOf("@")||-1==e.user.email.indexOf("."))e.errMessage="Invalid Email/Password";else{var i=this;n.signin(e.user).success(function(n){return"Oops! Wrong password"!=n?(o.token=n.token,o.number=n.company_phone_number,o.company_name=n.company_name,o.admin_id=n.admin_id,o.email=e.user.email,r.emit("_admin_id",{_admin_id:o.admin_id}),t.path("../../../dashboard/views/dashboard.html"),n):void(e.errMessage="Invalid Email/Password")}).error(function(o){return console.log("failure"),e.errMessage="Invalid Email/Password",o})}}}]),angular.module("signin").service("SigninService",["$http",function(e){this.login=function(o){return e.post("/auth/login",o)}}]),angular.module("DashboardFormBuilderModule").controller("DeleteModalInstanceCtrl",["$modalInstance",DeleteModalInstanceCtrl]),angular.module("DashboardFormBuilderModule").controller("FormCreateController",function(e,o,t,n,r,i){e.templateId=0,e.previewMode=!1,e.editMode=!1,e.showDelete=!1,e.showReset=!1,e.form={},e.form.form_name="My Form",e.form.form_fields=[],e.previewForm={},e.addField={},e.addField.types=t.fields,e.addField["new"]=e.addField.types[0].name,e.addField.lastAddedID=1,e.accordion={},e.accordion.oneAtATime=!0,e.$on("$viewContentLoaded",function(){n.get("/api/form/template/company/"+i.admin_id).success(function(o,n,r,i){if(console.log(o),"undefined"!=typeof o.template&&null!==typeof o.template&&"undefined"!=typeof o.template.form_fields&&null!==o.template.form_fields){for(var l=0;l<o.template.form_fields.length;l++)o.template.form_fields[l].field_readonly=!0;console.log(o.template),e.form=o.template,e.form.submitted=!1,t.formData=o.template,o.template.form_fields?e.addField.lastAddedID=e.form.form_fields.length:e.form.form_fields=[]}else{console.log("New form");var a={field_id:1,field_title:"Name",field_type:"textfield",field_placeholder:"Name",field_required:!0,field_disabled:!1,field_readonly:!0};e.form.form_fields.push(a),e.previewMode===!1&&(e.previewMode=!0),e.form.submitted=!1,t.formData=e.form}console.log(o)}).error(function(e,o,t,n){}),e.previewMode=!0}),e.addNewField=function(){e.addField.lastAddedID++;var o={field_id:e.addField.lastAddedID,field_title:"New field - "+e.addField.lastAddedID,field_type:e.addField["new"],field_placeholder:"",field_required:!0,field_disabled:!1,field_readonly:!0};e.form.form_fields.push(o),e.previewMode===!1&&(e.previewMode=!0),e.form.submitted=!1,t.formData=e.form},e.deleteField=function(o){for(var t=0;t<e.form.form_fields.length;t++)if(e.form.form_fields[t].field_id==o){e.form.form_fields.splice(t,1);break}(null===e.form.form_fields||0===e.form.form_fields.length)&&(e.previewMode=!1,e.form.submitted=!1)},e.addOption=function(e){e.field_options||(e.field_options=[]);var o=0;e.field_options[e.field_options.length-1]&&(o=e.field_options[e.field_options.length-1].option_id);var t=o+1,n={option_id:t,option_title:"Option "+t,option_value:t};e.field_options.push(n)},e.deleteOption=function(e,o){for(var t=0;t<e.field_options.length;t++)if(e.field_options[t].option_id==o.option_id){e.field_options.splice(t,1);break}},e.showAddOptions=function(e){return"radio"==e.field_type||"dropdown"==e.field_type?!0:!1},e.reset=function(){null!==e.form.form_fields&&0!==e.form.form_fields.length&&(e.form.form_fields.splice(1,e.form.form_fields.length),e.addField.lastAddedID=0,e.previewMode=!0,e.form.submitted=!1)}}),angular.module("DashboardFormBuilderModule").controller("FormEditController",function(e,o,t,n,r,i){e.templateId=0,e.prevJson=r("json")(e.form),e.previewMode=!1,e.editMode=!1,e.form={},e.form.form_id=1,e.form.form_name="My Form",e.form.form_fields=[],e.previewForm={},e.addField={},e.addField.types=t.fields,e.addField["new"]=e.addField.types[0].name,e.addField.lastAddedID=0,e.accordion={},e.accordion.oneAtATime=!0,e.addNewField=function(){e.addField.lastAddedID++;var o={field_id:e.addField.lastAddedID,field_title:"New field - "+e.addField.lastAddedID,field_type:e.addField["new"],field_placeholder:"",field_required:!0,field_disabled:!1};e.form.form_fields.push(o),0==e.previewMode&&(e.previewMode=!0),e.form.submitted=!1};var l=function(){for(var o=0;o<e.form.form_fields.length;o++)("radio"!=e.form.form_fields[o].field_type||"dropdown"!=e.addField["new"])&&(e.form.form_fields[o].field_options=[])};e.deleteField=function(t){var n=o.open({templateUrl:"views/components/dashboard/formBuilder/views/deleteModal.html",controller:"DeleteModalInstanceCtrl",controllerAs:"vm"});n.result.then(function(){for(var o=0;o<e.form.form_fields.length;o++)if(e.form.form_fields[o].field_id==t){e.form.form_fields.splice(o,1);break}(null===e.form.form_fields||0===e.form.form_fields.length)&&(e.previewMode=!1,e.form.submitted=!1)},function(){})},e.addOption=function(e){e.field_options||(e.field_options=[]);var o=0;e.field_options[e.field_options.length-1]&&(o=e.field_options[e.field_options.length-1].option_id);var t=o+1,n={option_id:t,option_title:"Option "+t,option_value:t};e.field_options.push(n)},e.deleteOption=function(e,o){for(var t=0;t<e.field_options.length;t++)if(e.field_options[t].option_id==o.option_id){e.field_options.splice(t,1);break}},e.postJson=function(){l();var o=r("json")(e.form),t={template:o,template_id:e.templateId};n.put("/api/form/template",t).success(function(e,o,t,n){console.log("put success"),alert("Data successfully Updated!"),console.log(e)}).error(function(e,o,t,n){console.log("no forms posted")})},e.fetchSavedTemplate=function(){n.get("/api/form/template/company/54f8f23546b787e8335980e7").success(function(o,t,n,r){console.log(o),e.templateId=o._id,e.form=JSON.parse(o.template),e.addField.lastAddedID=e.form.form_fields.length}).error(function(e,o,t,n){
alert("You have no saved templates.")})},e.$on("$viewContentLoaded",function(){n.get("/api/form/template/company/54f8f23546b787e8335980e7").success(function(o,t,n,r){console.log(o),e.templateId=o._id,e.form=JSON.parse(o.template),e.addField.lastAddedID=e.form.form_fields.length,0==e.previewMode&&(e.previewMode=!0),e.form.submitted=!1}).error(function(e,o,t,n){alert("You have no saved templates.")})}),e.editOn=function(){i.path("/createform")},e.showAddOptions=function(e){return"radio"==e.field_type||"dropdown"==e.field_type?!0:!1},e.reset=function(){if(null!==e.form.form_fields&&0!==e.form.form_fields.length){var t=o.open({templateUrl:"views/components/dashboard/formBuilder/views/deleteModal.html",controller:"DeleteModalInstanceCtrl",controllerAs:"vm"});t.result.then(function(){e.form.form_fields.splice(0,e.form.form_fields.length),e.addField.lastAddedID=0,e.previewMode=!1,e.form.submitted=!1},function(){})}}}),angular.module("DashboardFormBuilderModule").controller("ModalInstanceCtrl",["$modalInstance",ModalInstanceCtrl]),angular.module("DashboardFormBuilderModule").controller("ViewCtrl",function(e,o,t){e.form={},o.form(t.id).then(function(o){e.form=o})}),angular.module("DashboardFormBuilderModule").directive("fieldDirective",function(e,o){var t=function(e){var o=e.field_type,t="";switch(o){case"textfield":t="views/components/dashboard/formBuilder/views/directive-templates/field/textfield.html";break;case"email":t="views/components/dashboard/formBuilder/views/directive-templates/field/email.html";break;case"textarea":t="views/components/dashboard/formBuilder/views/directive-templates/field/textarea.html";break;case"checkbox":t="views/components/dashboard/formBuilder/views/directive-templates/field/checkbox.html";break;case"date":t="views/components/dashboard/formBuilder/views/directive-templates/field/date.html";break;case"dropdown":t="views/components/dashboard/formBuilder/views/directive-templates/field/dropdown.html";break;case"hidden":t="views/components/dashboard/formBuilder/views/directive-templates/field/hidden.html";break;case"password":t="views/components/dashboard/formBuilder/views/directive-templates/field/password.html";break;case"radio":t="views/components/dashboard/formBuilder/views/directive-templates/field/radio.html"}return t},n=function(n,r){var i=t(n.field);e.get(i).success(function(e){r.html(e),o(r.contents())(n)})};return{template:"<div>{{field}}</div>",restrict:"E",scope:{field:"="},link:n}}),angular.module("DashboardFormBuilderModule").directive("formDirective",function(){return{controller:function(e,o,t,n){function r(){console.log("redirecttoCheckin"),e.form.submitted=!1}e.submit=function(){e.form.submitted=!0;for(var t=0;t<e.form.form_fields.length;t++)e.form.form_fields[t].field_readonly=!1,e.form.form_fields[t].field_id=t+1,console.log(e.form.form_fields);o.formData.submitted=!0,o.createNewForm(o.formData),n(r,5e3)}},templateUrl:"views/components/dashboard/formBuilder/views/directive-templates/form/form.html",restrict:"E",scope:{form:"="}}}),angular.module("DashboardFormBuilderModule").service("FormService",function t(e,o){var t="./static-data/sample_forms.json";return{fields:[{name:"textfield",value:"Textfield"},{name:"email",value:"E-mail"},{name:"password",value:"Password"},{name:"radio",value:"Radio Buttons"},{name:"dropdown",value:"Dropdown List"},{name:"date",value:"Date"},{name:"textarea",value:"Text Area"},{name:"checkbox",value:"Checkbox"},{name:"hidden",value:"Hidden"}],formData:{},form:function(o){return e.get(t).then(function(e){console.log("ddd",e);var t={};return angular.forEach(e.data,function(e){e.form_id==o&&(t=e)}),t})},forms:function(){return e.get(t).then(function(e){return e.data})},getForm:function(){return e.get("api/form/template/company/"+o.admin_id).then(function(e){return e})},createNewForm:function(t){return console.log("create "),console.log(t),e.post("api/form/template/"+o.admin_id,{template:t})}}}),angular.module("theme").controller("themeController",["$scope",function(e){e.arrayOfUrl=["/images/1.jpg","/images/2.jpg","/images/3.jpg","/images/4.jpg","/images/5.jpg"]}]),angular.module("theme").directive("themeChoice",function(){return{restrict:"E",templateUrl:"views/components/dashboard/formBuilder/themeChoice/views/themeChoice.html",controller:"ThemeController",controllerAs:"themeCtrl"}}).controller("themeController",["$scope",function(e){e.arrayOfUrl=["/images/1.jpg","/images/2.jpg","/images/3.jpg","/images/4.jpg","/images/5.jpg"]}]);
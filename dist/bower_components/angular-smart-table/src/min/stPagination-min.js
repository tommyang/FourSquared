ng.module("smart-table").directive("stPagination",function(){return{restrict:"EA",require:"^stTable",scope:{stItemsByPage:"=?",stDisplayedPages:"=?",stPageChange:"&"},templateUrl:function(e,t){return t.stTemplate?t.stTemplate:"template/smart-table/pagination.html"},link:function(e,t,a,s){function n(){var t=s.tableState().pagination,a=1,n,g,r=e.currentPage;for(e.currentPage=Math.floor(t.start/t.number)+1,a=Math.max(a,e.currentPage-Math.abs(Math.floor(e.stDisplayedPages/2))),n=a+e.stDisplayedPages,n>t.numberOfPages&&(n=t.numberOfPages+1,a=Math.max(1,n-e.stDisplayedPages)),e.pages=[],e.numPages=t.numberOfPages,g=a;n>g;g++)e.pages.push(g);r!==e.currentPage&&e.stPageChange({newPage:e.currentPage})}e.stItemsByPage=e.stItemsByPage?+e.stItemsByPage:10,e.stDisplayedPages=e.stDisplayedPages?+e.stDisplayedPages:5,e.currentPage=1,e.pages=[],e.$watch(function(){return s.tableState().pagination},n,!0),e.$watch("stItemsByPage",function(t,a){t!==a&&e.selectPage(1)}),e.$watch("stDisplayedPages",n),e.selectPage=function(t){t>0&&t<=e.numPages&&s.slice((t-1)*e.stItemsByPage,e.stItemsByPage)},s.tableState().pagination.number||s.slice(0,e.stItemsByPage)}}});
function UrlMatcher(e,t,r){function n(t,r,n,i){if(d.push(t),l[t])return l[t];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(t))throw new Error("Invalid parameter name '"+t+"' in pattern '"+e+"'");if(h[t])throw new Error("Duplicate parameter name '"+t+"' in pattern '"+e+"'");return h[t]=new $$UMFP.Param(t,r,n,i),h[t]}function i(e,t,r){var n=["",""],i=e.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!t)return i;switch(r){case!1:n=["(",")"];break;case!0:n=["?(",")?"];break;default:n=["("+r+"|",")?"]}return i+n[0]+t+n[1]}function a(r,n){var i,a,o,u,s,f;return i=r[2]||r[3],s=t.params[i],o=e.substring(c,r.index),a=n?r[4]:r[4]||("*"==r[1]?".*":null),u=$$UMFP.type(a||"string")||inherit($$UMFP.type("string"),{pattern:new RegExp(a)}),{id:i,regexp:a,segment:o,type:u,cfg:s}}t=extend({params:{}},isObject(t)?t:{});var o=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,u=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,s="^",c=0,f,p=this.segments=[],l=r?r.params:{},h=this.params=r?r.params.$$new():new $$UMFP.ParamSet,d=[];this.source=e;for(var y,v,g;(f=o.exec(e))&&(y=a(f,!1),!(y.segment.indexOf("?")>=0));)v=n(y.id,y.type,y.cfg,"path"),s+=i(y.segment,v.type.pattern.source,v.squash),p.push(y.segment),c=o.lastIndex;g=e.substring(c);var m=g.indexOf("?");if(m>=0){var w=this.sourceSearch=g.substring(m);if(g=g.substring(0,m),this.sourcePath=e.substring(0,c+m),w.length>0)for(c=0;f=u.exec(w);)y=a(f,!0),v=n(y.id,y.type,y.cfg,"search"),c=o.lastIndex}else this.sourcePath=e,this.sourceSearch="";s+=i(g)+(t.strict===!1?"/?":"")+"$",p.push(g),this.regexp=new RegExp(s,t.caseInsensitive?"i":void 0),this.prefix=p[0],this.$$paramNames=d}function Type(e){extend(this,e)}function $UrlMatcherFactory(){function e(e){return null!=e?e.toString().replace(/\//g,"%2F"):e}function t(e){return null!=e?e.toString().replace(/%2F/g,"/"):e}function r(e){return this.pattern.test(e)}function n(){return{strict:s,caseInsensitive:u}}function i(e){return isFunction(e)||isArray(e)&&isFunction(e[e.length-1])}function a(){for(;l.length;){var e=l.shift();if(e.pattern)throw new Error("You cannot override a type's .pattern at runtime.");angular.extend(f[e.name],h.invoke(e.def))}}function o(e){extend(this,e||{})}$$UMFP=this;var u=!1,s=!0,c=!1,f={},p=!0,l=[],h,d={string:{encode:e,decode:t,is:r,pattern:/[^/]*/},"int":{encode:e,decode:function(e){return parseInt(e,10)},is:function(e){return isDefined(e)&&this.decode(e.toString())===e},pattern:/\d+/},bool:{encode:function(e){return e?1:0},decode:function(e){return 0!==parseInt(e,10)},is:function(e){return e===!0||e===!1},pattern:/0|1/},date:{encode:function(e){return this.is(e)?[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-"):void 0},decode:function(e){if(this.is(e))return e;var t=this.capture.exec(e);return t?new Date(t[1],t[2]-1,t[3]):void 0},is:function(e){return e instanceof Date&&!isNaN(e.valueOf())},equals:function(e,t){return this.is(e)&&this.is(t)&&e.toISOString()===t.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^/]*/},any:{encode:angular.identity,decode:angular.identity,is:angular.identity,equals:angular.equals,pattern:/.*/}};$UrlMatcherFactory.$$getDefaultValue=function(e){if(!i(e.value))return e.value;if(!h)throw new Error("Injectable functions cannot be called at configuration time");return h.invoke(e.value)},this.caseInsensitive=function(e){return isDefined(e)&&(u=e),u},this.strictMode=function(e){return isDefined(e)&&(s=e),s},this.defaultSquashPolicy=function(e){if(!isDefined(e))return c;if(e!==!0&&e!==!1&&!isString(e))throw new Error("Invalid squash policy: "+e+". Valid policies: false, true, arbitrary-string");return c=e,e},this.compile=function(e,t){return new UrlMatcher(e,extend(n(),t))},this.isMatcher=function(e){if(!isObject(e))return!1;var t=!0;return forEach(UrlMatcher.prototype,function(r,n){isFunction(r)&&(t=t&&isDefined(e[n])&&isFunction(e[n]))}),t},this.type=function(e,t,r){if(!isDefined(t))return f[e];if(f.hasOwnProperty(e))throw new Error("A type named '"+e+"' has already been defined.");return f[e]=new Type(extend({name:e},t)),r&&(l.push({name:e,def:r}),p||a()),this},forEach(d,function(e,t){f[t]=new Type(extend({name:t},e))}),f=inherit(f,{}),this.$get=["$injector",function(e){return h=e,p=!1,a(),forEach(d,function(e,t){f[t]||(f[t]=new Type(e))}),this}],this.Param=function y(e,t,r,n){function a(e){var t=isObject(e)?objectKeys(e):[],r=-1===indexOf(t,"value")&&-1===indexOf(t,"type")&&-1===indexOf(t,"squash")&&-1===indexOf(t,"array");return r&&(e={value:e}),e.$$fn=i(e.value)?e.value:function(){return e.value},e}function o(t,r,n){if(t.type&&r)throw new Error("Param '"+e+"' has two type configurations.");return r?r:t.type?t.type instanceof Type?t.type:new Type(t.type):"config"===n?f.any:f.string}function u(){var t={array:"search"===n?"auto":!1},i=e.match(/\[\]$/)?{array:!0}:{};return extend(t,i,r).array}function s(e,t){var r=e.squash;if(!t||r===!1)return!1;if(!isDefined(r)||null==r)return c;if(r===!0||isString(r))return r;throw new Error("Invalid squash policy: '"+r+"'. Valid policies: false, true, or arbitrary string")}function p(e,t,r,n){var i,a,o=[{from:"",to:r||t?void 0:""},{from:null,to:r||t?void 0:""}];return i=isArray(e.replace)?e.replace:[],isString(n)&&i.push({from:n,to:void 0}),a=map(i,function(e){return e.from}),filter(o,function(e){return-1===indexOf(a,e.from)}).concat(i)}function l(){if(!h)throw new Error("Injectable functions cannot be called at configuration time");return h.invoke(r.$$fn)}function d(e){function t(e){return function(t){return t.from===e}}function r(e){var r=map(filter(v.replace,t(e)),function(e){return e.to});return r.length?r[0]:e}return e=r(e),isDefined(e)?v.type.decode(e):l()}function y(){return"{Param:"+e+" "+t+" squash: '"+w+"' optional: "+m+"}"}var v=this;r=a(r),t=o(r,t,n);var g=u();t=g?t.$asArray(g,"search"===n):t,"string"!==t.name||g||"path"!==n||void 0!==r.value||(r.value="");var m=void 0!==r.value,w=s(r,m),x=p(r,g,m,w);extend(this,{id:e,type:t,location:n,array:g,squash:w,replace:x,isOptional:m,value:d,dynamic:void 0,config:r,toString:y})},o.prototype={$$new:function(){return inherit(this,extend(new o,{$$parent:this}))},$$keys:function(){for(var e=[],t=[],r=this,n=objectKeys(o.prototype);r;)t.push(r),r=r.$$parent;return t.reverse(),forEach(t,function(t){forEach(objectKeys(t),function(t){-1===indexOf(e,t)&&-1===indexOf(n,t)&&e.push(t)})}),e},$$values:function(e){var t={},r=this;return forEach(r.$$keys(),function(n){t[n]=r[n].value(e&&e[n])}),t},$$equals:function(e,t){var r=!0,n=this;return forEach(n.$$keys(),function(i){var a=e&&e[i],o=t&&t[i];n[i].type.equals(a,o)||(r=!1)}),r},$$validates:function v(e){var t=!0,r,n,i,a=this;return forEach(this.$$keys(),function(o){i=a[o],n=e[o],r=!n&&i.isOptional,t=t&&(r||!!i.type.is(n))}),t},$$parent:void 0},this.ParamSet=o}var $$UMFP;UrlMatcher.prototype.concat=function(e,t){var r={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+e+this.sourceSearch,extend(r,t),this)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(e,t){function r(e){function t(e){return e.split("").reverse().join("")}function r(e){return e.replace(/\\-/,"-")}var n=t(e).split(/-(?!\\)/),i=map(n,t);return map(i,r).reverse()}var n=this.regexp.exec(e);if(!n)return null;t=t||{};var i=this.parameters(),a=i.length,o=this.segments.length-1,u={},s,c,f,p;if(o!==n.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(s=0;o>s;s++){p=i[s];var l=this.params[p],h=n[s+1];for(c=0;c<l.replace;c++)l.replace[c].from===h&&(h=l.replace[c].to);h&&l.array===!0&&(h=r(h)),u[p]=l.value(h)}for(;a>s;s++)p=i[s],u[p]=this.params[p].value(t[p]);return u},UrlMatcher.prototype.parameters=function(e){return isDefined(e)?this.params[e]||null:this.$$paramNames},UrlMatcher.prototype.validates=function(e){return this.params.$$validates(e)},UrlMatcher.prototype.format=function(e){function t(e){return encodeURIComponent(e).replace(/-/g,function(e){return"%5C%"+e.charCodeAt(0).toString(16).toUpperCase()})}e=e||{};var r=this.segments,n=this.parameters(),i=this.params;if(!this.validates(e))return null;var a,o=!1,u=r.length-1,s=n.length,c=r[0];for(a=0;s>a;a++){var f=u>a,p=n[a],l=i[p],h=l.value(e[p]),d=l.isOptional&&l.type.equals(l.value(),h),y=d?l.squash:!1,v=l.type.encode(h);if(f){var g=r[a+1];if(y===!1)null!=v&&(c+=isArray(v)?map(v,t).join("-"):encodeURIComponent(v)),c+=g;else if(y===!0){var m=c.match(/\/$/)?/\/?(.*)/:/(.*)/;c+=g.match(m)[1]}else isString(y)&&(c+=y+g)}else{if(null==v||d&&y!==!1)continue;isArray(v)||(v=[v]),v=map(v,encodeURIComponent).join("&"+p+"="),c+=(o?"&":"?")+(p+"="+v),o=!0}}return c},Type.prototype.is=function(e,t){return!0},Type.prototype.encode=function(e,t){return e},Type.prototype.decode=function(e,t){return e},Type.prototype.equals=function(e,t){return e==t},Type.prototype.$subPattern=function(){var e=this.pattern.toString();return e.substr(1,e.length-2)},Type.prototype.pattern=/.*/,Type.prototype.toString=function(){return"{Type:"+this.name+"}"},Type.prototype.$asArray=function(e,t){function r(e,t){function r(e,t){return function(){return e[t].apply(e,arguments)}}function n(e){return isArray(e)?e:isDefined(e)?[e]:[]}function i(e){switch(e.length){case 0:return;case 1:return"auto"===t?e[0]:e;default:return e}}function a(e){return!e}function o(e,t){return function r(o){o=n(o);var u=map(o,e);return t===!0?0===filter(u,a).length:i(u)}}function u(e){return function t(r,i){var a=n(r),o=n(i);if(a.length!==o.length)return!1;for(var u=0;u<a.length;u++)if(!e(a[u],o[u]))return!1;return!0}}this.encode=o(r(e,"encode")),this.decode=o(r(e,"decode")),this.is=o(r(e,"is"),!0),this.equals=u(r(e,"equals")),this.pattern=e.pattern,this.$arrayMode=t}if(!e)return this;if("auto"===e&&!t)throw new Error("'auto' array mode is for query parameters only");return new r(this,e)},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),angular.module("ui.router.util").run(["$urlMatcherFactory",function(e){}]);
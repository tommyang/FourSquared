/*
formBuilder - http://kevinchappell.github.io/formBuilder/
Version: 1.9.4
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},formBuilderHelpers=function(e,t){var a={doCancel:!1};return t.events=formBuilderEvents(e,a),a.attrString=function(e){var t=[];for(var l in e)e.hasOwnProperty(l)&&(l=a.safeAttr(l,e[l]),t.push(l.name+l.value));return t.join(" ")},a.hyphenCase=function(e){return e=e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()}),e.replace(/\s/g,"-").replace(/^-+/g,"")},a.safeAttrName=function(e){var t={className:"class"};return t[e]||a.hyphenCase(e)},a.safeAttr=function(e,t){return e=a.safeAttrName(e),t=window.JSON.stringify(t),t=t?"="+t:"",{name:e,value:t}},a.mobileClass=function(){var e="";return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=" fb-mobile")}(navigator.userAgent||navigator.vendor||window.opera),e},a.startMoving=function(e,t){e=e,t.item.show().addClass("moving"),a.startIndex=$("li",this).index(t.item)},a.stopMoving=function(e,t){e=e,t.item.removeClass("moving"),a.doCancel&&($(t.sender).sortable("cancel"),$(this).sortable("cancel")),a.save(),a.doCancel=!1},a.beforeStop=function(t,l){t=t;var s=document.getElementById(e.formID),o=s.children.length-1,n=[];a.stopIndex=l.placeholder.index()-1,l.item.parent().hasClass("frmb-control")&&n.push(!0),e.prepend&&n.push(0===a.stopIndex),e.append&&n.push(a.stopIndex+1===o),a.doCancel=n.some(function(e){return e===!0})},a.safename=function(e){return e.replace(/\s/g,"-").replace(/[^a-zA-Z0-9\-]/g,"").toLowerCase()},a.forceNumber=function(e){return e.replace(/[^0-9]/g,"")},a.initTooltip=function(e){var t=e.find(".tooltip");e.mouseenter(function(){t.outerWidth()>200&&t.addClass("max-width"),t.css("left",e.width()+14),t.stop(!0,!0).fadeIn("fast")}).mouseleave(function(){e.find(".tooltip").stop(!0,!0).fadeOut("fast")}),t.hide()},a.xmlSave=function(e){var a=$(e).toXML();return window.JSON.stringify(a)===window.JSON.stringify(t.formData)?!1:void(t.formData=a)},a.jsonSave=function(){e.notify.warning("json data not available yet")},a.save=function(){var l=a.getElement(),s=document.getElementById(e.formID),o={xml:a.xmlSave,json:a.jsonSave};o[e.dataType](s),l&&(l.value=t.formData,window.jQuery?$(l).trigger("change"):l.onchange())},a.getElement=function(){var l=!1;return t.element&&(l=t.element,l.id||a.makeId(l),l.onchange||(l.onchange=function(){e.notify.success(e.messages.formUpdated)})),l},a.makeId=function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],t=(new Date).getTime();return e.tagName+"-"+t},a.updatePreview=function(e){var t=e.data("fieldData")||{},l=e.attr("class");if(-1===l.indexOf("ui-sortable-handle")){var s,o=$(".prev-holder",e),n=$(".fld-subtype",e).val();l=l.replace("-field form-field",""),s=n?n:l;var i,r={type:s,label:$(".fld-label",e).val()},c=$(".fld-maxlength",e);c&&(r.maxlength=c.val()),r.className=$(".fld-className",e).val()||t.className||"";var d=$(".fld-placeholder",e).val();d&&(r.placeholder=d);var p=$(".btn-style",e).val();p&&(r.style=p),"checkbox"===l&&(r.toggle=$(".checkbox-toggle",e).is(":checked")),l.match(/(select|checkbox-group|radio-group)/)&&(r.values=[],r.multiple=$('[name="multiple"]',e).is(":checked"),$(".sortable-options li",e).each(function(){var e={};e.selected=$(".option-selected",this).is(":checked"),e.value=$(".option-value",this).val(),e.label=$(".option-label",this).val(),r.values.push(e)})),r.className=a.classNames(e,r),e.data("fieldData",r),i=a.fieldPreview(r),o.html(i),$("input[toggle]",o).kcToggle()}},a.fieldPreview=function(t){var l,s="",o=(new Date).getTime(),n=t.toggle?"toggle":"",i=a.attrString(t);switch(t.type){case"textarea":case"rich-text":s="<textarea "+i+"></textarea>";break;case"button":case"submit":s="<button "+i+">"+t.label+"</button>";break;case"select":var r="",c=t.multiple?"multiple":"";for(t.values.reverse(),t.placeholder&&(r+="<option disabled selected>"+t.placeholder+"</option>"),l=t.values.length-1;l>=0;l--){var d=t.values[l].selected&&!t.placeholder?"selected":"";r+='<option value="'+t.values[l].value+'" '+d+">"+t.values[l].label+"</option>"}s="<"+t.type+' class="'+t.className+'" '+c+">"+r+"</"+t.type+">";break;case"checkbox-group":case"radio-group":var p=t.type.replace("-group",""),u=p+"-"+o;for(t.values.reverse(),l=t.values.length-1;l>=0;l--){var m=t.values[l].selected?"checked":"",f=p+"-"+o+"-"+l;s+='<div><input type="'+p+'" class="'+t.className+'" name="'+u+'" id="'+f+'" value="'+t.values[l].value+'" '+m+'/><label for="'+f+'">'+t.values[l].label+"</label></div>"}break;case"text":case"password":case"email":case"date":case"file":s="<input "+i+">";break;case"color":s='<input type="'+t.type+'" class="'+t.className+'"> '+e.messages.selectColor;break;case"hidden":case"checkbox":s='<input type="'+t.type+'" '+n+" >";break;case"autocomplete":s='<input class="ui-autocomplete-input '+t.className+'" autocomplete="on">';break;default:s="<"+t.type+"></"+t.type+">"}return s},a.updateMultipleSelect=function(){$(document.getElementById(e.formID)).on("change",'input[name="multiple"]',function(){var e=$(this).parents(".field-options:eq(0)").find(".sortable-options input.option-selected");this.checked?e.each(function(){$(this).prop("type","checkbox")}):e.each(function(){$(this).removeAttr("checked").prop("type","radio")})})},a.debounce=function(e){var t,a=arguments.length<=1||void 0===arguments[1]?250:arguments[1],l=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return function(){var s=this,o=arguments,n=function(){t=null,l||e.apply(s,o)},i=l&&!t;clearTimeout(t),t=setTimeout(n,a),i&&e.apply(s,o)}},a.htmlEncode=function(e){return $("<div/>").text(e).html()},a.htmlDecode=function(e){return $("<div/>").html(e).text()},a.validateForm=function(){var t=$(document.getElementById(e.formID)),a=[];$('input[name="label"], input[type="text"].option',t).each(function(){if(""===$(this).val()){var t=$(this).parents("li.form-field"),l=$(this);a.push({field:t,error:e.messages.labelEmpty,attribute:l})}}),a.length&&(alert("Error: "+a[0].error),$("html, body").animate({scrollTop:a[0].field.offset().top},1e3,function(){var e=$(".toggle-form",a[0].field).attr("id");$(".toggle-form",a[0].field).addClass("open").parent().next(".prev-holder").slideUp(250),$("#"+e+"-fld").slideDown(250,function(){a[0].attribute.addClass("error")})}))},a.disabledTT={className:"frmb-tt",add:function(t){var l=e.messages.fieldNonEditable;if(l){var s=a.markup("p",l,{className:a.disabledTT.className});t.append(s)}},remove:function(e){$(".frmb-tt",e).remove()}},a.classNames=function(e,t){var a=["checkbox","checkbox-group","radio-group","button"],l=t.type,s=t.style,o=[],n={button:"btn",submit:"btn"},i=e[0].querySelector(".fld-className").value,r=n[l];return i&&o.push(i),r?(o.push(r),s&&o.push(r+"-"+s)):-1===a.indexOf(l)&&o.push("form-control"),o.join(" ")},a.markup=function(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1],l=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],s=void 0,o=document.createElement(e),n=function(e){return Array.isArray(e)?"array":"undefined"==typeof e?"undefined":_typeof(e)},i={string:function(e){o.innerHTML=e},object:function(e){return o.appendChild(e)},array:function(e){for(var t=0;t<e.length;t++)s=n(e[t]),i[s](e[t])}};for(var r in l)if(l.hasOwnProperty(r)){var c=a.safeAttrName(r);o.setAttribute(c,l[r])}return s=n(t),t&&i[s].call(this,t),o},a.closeConfirm=function(e,a){e=e||document.getElementsByClassName("form-builder-overlay")[0],a=a||document.getElementsByClassName("form-builder-dialog")[0],e.classList.remove("visible"),a.remove(),e.remove(),document.dispatchEvent(t.events.modalClosed)},a.showOverlay=function(){var e=a.markup("div",null,{className:"form-builder-overlay"});return document.body.appendChild(e),e.classList.add("visible"),e.onclick=function(){a.closeConfirm(e)},e},a.confirm=function(t,l){var s=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],o=arguments.length<=3||void 0===arguments[3]?"":arguments[3],n=a.showOverlay(),i=a.markup("button",e.messages.yes,{className:"yes btn btn-success btn-sm"}),r=a.markup("button",e.messages.no,{className:"no btn btn-danger btn-sm"});r.onclick=function(){a.closeConfirm(n)},i.onclick=function(){l(),a.closeConfirm(n)};var c=a.markup("div",[r,i],{className:"button-wrap"});o="form-builder-dialog "+o;var d=a.markup("div",[t,c],{className:o});return s?d.classList.add("positioned"):(s={pageX:Math.max(document.documentElement.clientWidth,window.innerWidth||0)/2,pageY:Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2},d.style.position="fixed"),d.style.left=s.pageX+"px",d.style.top=s.pageY+"px",document.body.appendChild(d),i.focus(),d},a.dialog=function(e){var l=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],s=arguments.length<=2||void 0===arguments[2]?"":arguments[2];a.showOverlay(),s="form-builder-dialog "+s;var o=a.markup("div",e,{className:s});return l?o.classList.add("positioned"):(l={pageX:Math.max(document.documentElement.clientWidth,window.innerWidth||0)/2,pageY:Math.max(document.documentElement.clientHeight,window.innerHeight||0)/2},o.style.position="fixed"),o.style.left=l.pageX+"px",o.style.top=l.pageY+"px",document.body.appendChild(o),-1!==s.indexOf("data-dialog")&&document.dispatchEvent(t.events.viewData),o},a.removeAllfields=function(){var t=document.getElementById(e.formID),a=t.querySelectorAll("li.form-field"),l=$(a),s=[];e.prepend&&s.push(!0),e.append&&s.push(!0),s.some(function(e){return e===!0})||t.parentElement.classList.add("empty"),t.classList.add("removing");var o=0;l.each(function(){o+=$(this).outerHeight()+3}),a[0].style.marginTop=-o+"px",setTimeout(function(){l.remove(),document.getElementById(e.formID).classList.remove("removing")},500)},a},formBuilderEvents=function(e,t){var a={};return a.loaded=new Event("loaded"),a.viewData=new Event("viewData"),a.userDeclined=new Event("userDeclined"),a.modalClosed=new Event("modalClosed"),a};!function(e){var t=function(t,a){var l={theme:"fresh",labels:{off:"Off",on:"On"}},s=e.extend(l,a),o=e('<div class="kc-toggle"/>').insertAfter(t).append(t);o.toggleClass("on",t.is(":checked"));var n='<div class="kct-on">'+s.labels.on+"</div>",i='<div class="kct-off">'+s.labels.off+"</div>",r='<div class="kct-handle"></div>',c='<div class="kct-inner">'+n+r+i+"</div>";o.append(c),o.click(function(){t.attr("checked",!t.attr("checked")),e(this).toggleClass("on")})};e.fn.kcToggle=function(a){var l=this;return l.each(function(){var l=e(this);if(!l.data("kcToggle")){var s=new t(l,a);l.data("kcToggle",s)}})}}(jQuery),function(e){var t=function(t,a){var l=this,s={dataType:"xml",disableFields:{},append:!1,prepend:!1,defaultFields:[],fieldRemoveWarn:!1,roles:{1:"Administrator"},serializePrefix:"frmb",messages:{addOption:"Add Option",allFieldsRemoved:"All fields were removed.",allowSelect:"Allow Select",autocomplete:"Autocomplete",button:"Button",cannotBeEmpty:"This field cannot be empty",checkboxGroup:"Checkbox Group",checkbox:"Checkbox",checkboxes:"Checkboxes",className:"Class",clearAllMessage:"Are you sure you want to remove all items?",clearAll:"Clear",close:"Close",copy:"Copy To Clipboard",dateField:"Date Field",description:"Help Text",descriptionField:"Description",devMode:"Developer Mode",editNames:"Edit Names",editorTitle:"Form Elements",editXML:"Edit XML",fieldDeleteWarning:!1,fieldVars:"Field Variables",fieldNonEditable:"This field cannot be edited.",fieldRemoveWarning:"Are you sure you want to remove this field?",fileUpload:"File Upload",formUpdated:"Form Updated",getStarted:"Drag a field from the right to this area",hide:"Edit",hidden:"Hidden Input",label:"Label",labelEmpty:"Field Label cannot be empty",limitRole:"Limit access to one or more of the following roles:",mandatory:"Mandatory",maxlength:"Max Length",minOptionMessage:"This field requires a minimum of 2 options",name:"Name",no:"No",off:"Off",on:"On",option:"Option",optional:"optional",optionLabelPlaceholder:"Label",optionValuePlaceholder:"Value",optionEmpty:"Option value required",paragraph:"Paragraph",placeholder:"Placeholder",placeholders:{value:"Value",label:"Label",text:"",textarea:"",email:"Enter you email",placeholder:"",className:"space separated classes",password:"Enter your password"},preview:"Preview",radioGroup:"Radio Group",radio:"Radio",removeMessage:"Remove Element",remove:"&#215;",required:"Required",richText:"Rich Text Editor",roles:"Access",save:"Save",selectOptions:"Options",select:"Select",selectColor:"Select Color",selectionsMessage:"Allow Multiple Selections",size:"Size",sizes:{xs:"Extra Small",sm:"Small",m:"Default",lg:"Large"},style:"Style",styles:{btn:{"default":"Default",danger:"Danger",info:"Info",primary:"Primary",success:"Success",warning:"Warning"}},subtype:"Type",subtypes:{text:["text","password","email","color"],button:["button","submit"]},text:"Text Field",textArea:"Text Area",toggle:"Toggle",warning:"Warning!",viewXML:"&lt;/&gt;",yes:"Yes"},notify:{error:function(e){return console.error(e)},success:function(e){return console.log(e)},warning:function(e){return console.warn(e)}}};s.messages.subtypes.password=s.messages.subtypes.text,s.messages.subtypes.email=s.messages.subtypes.text,s.messages.subtypes.color=s.messages.subtypes.text,s.messages.subtypes.submit=s.messages.subtypes.button;var o=e.extend(!0,s,t),n=e(a),i="frmb-"+e("ul[id^=frmb-]").length++;o.formID=i,l.element=a;for(var r=e("<ul/>").attr("id",i).addClass("frmb"),c=formBuilderHelpers(o,l),d=1,p=i+"-control-box",u=[{label:o.messages.text,attrs:{type:"text",className:"text-input",name:"text-input"}},{label:o.messages.select,attrs:{type:"select",className:"select",name:"select"}},{label:o.messages.textArea,attrs:{type:"textarea",className:"text-area",name:"textarea"}},{label:o.messages.radioGroup,attrs:{type:"radio-group",className:"radio-group",name:"radio-group"}},{label:o.messages.hidden,attrs:{type:"hidden",className:"hidden-input",name:"hidden-input"}},{label:o.messages.fileUpload,attrs:{type:"file",className:"file-input",name:"file-input"}},{label:o.messages.dateField,attrs:{type:"date",className:"calendar",name:"date-input"}},{label:o.messages.checkboxGroup,attrs:{type:"checkbox-group",className:"checkbox-group",name:"checkbox-group"}},{label:o.messages.checkbox,attrs:{type:"checkbox",className:"checkbox",name:"checkbox"}},{label:o.messages.button,attrs:{type:"button",className:"button-input",name:"button"}},{label:o.messages.autocomplete,attrs:{type:"autocomplete",className:"autocomplete",name:"autocomplete"}}],m=e("<ul/>",{id:p,"class":"frmb-control"}),f=u.length-1;f>=0;f--){var v=e("<li/>",{"class":"icon-"+u[f].attrs.className,type:u[f].type,name:u[f].className,label:u[f].label});for(var g in u[f])u[f].hasOwnProperty(g)&&v.data(g,u[f][g]);var h=c.markup("span",u[f].label);v.html(h).appendTo(m)}var b="xml"===o.dataType?o.messages.viewXML:o.messages.viewJSON,y=c.markup("button",b,{id:i+"-view-data",type:"button",className:"view-data btn btn-default"}),k=e("<a/>",{id:i+"-allow-select",text:o.messages.allowSelect,href:"#","class":"allow-select"}).prop("checked","checked"),x=e("<button/>",{id:i+"-edit-xml",text:o.messages.editXML,href:"#","class":"edit-xml btn btn-default"}),w=e("<a/>",{id:i+"-edit-names",text:o.messages.editNames,href:"#","class":"edit-names"}),C=c.markup("button",o.messages.clearAll,{id:i+"-clear-all",type:"button",className:"clear-all btn btn-default"}),N=c.markup("button",o.messages.save,{className:"btn btn-primary fb-save",id:i+"-save",type:"button"}),E=c.markup("div",[C,y,N],{className:"form-actions btn-group"}).outerHTML,T=e("<div/>",{id:i+"-action-links-inner","class":"action-links-inner"}).append(N,x," | ",w," | ",k," | "),M=e("<span/>",{"class":"dev-mode-link"}).html(o.messages.devMode+" "+o.messages.off),D=e("<div/>",{id:i+"-action-links","class":"action-links"}).append(T,M);r.sortable({cursor:"move",opacity:.9,revert:150,beforeStop:c.beforeStop,start:c.startMoving,stop:c.stopMoving,cancel:"input, select, .disabled, .form-group, .btn",placeholder:"frmb-placeholder"}),m.sortable({helper:"clone",opacity:.9,connectWith:r,cursor:"move",placeholder:"ui-state-highlight",start:c.startMoving,stop:c.stopMoving,revert:150,beforeStop:c.beforeStop,update:function(e,t){return c.doCancel?!1:(e=e,j(t.item,!0),void(c.doCancel=!0))}});var S=e("<div/>",{id:i+"-stage-wrap","class":"stage-wrap"}),L=e("<div/>",{id:i+"-form-wrap","class":"form-wrap form-builder"+c.mobileClass()});n.before(S).appendTo(S);var A=e("<div/>",{id:i+"-cb-wrap","class":"cb-wrap"}).append(m[0],E);S.append(r,A,D),S.before(L),L.append(S,A);var O=c.debounce(function(){var t=e(this).parents(".form-field:eq(0)");c.updatePreview(t),c.save()});r.on("change blur keyup",".form-elements input, .form-elements select",O);var q=function(){var t=""!==n.val()?e.parseXML(n.val()):!1,a=e(t).find("field");if(a.length>0)l.formData=t,a.each(function(){j(e(this))});else if(!t)if(o.defaultFields.length){o.defaultFields.reverse();for(var s=o.defaultFields.length-1;s>=0;s--)z(o.defaultFields[s]);S.removeClass("empty")}else o.prepend||o.append||S.addClass("empty").attr("data-content",o.messages.getStarted);e("li.form-field:not(.disabled)",r).each(function(){c.updatePreview(e(this))}),I()},$=function(){var e={xml:q,json:function(){console.log("coming soon")}};e[o.dataType]()},I=function(){var t=[];if(o.prepend&&!e(".disabled.prepend",r).length){var a=c.markup("li",o.prepend,{className:"disabled prepend"});t.push(!0),r.prepend(a)}if(o.append&&!e(".disabled.append",r).length){var l=c.markup("li",o.append,{className:"disabled append"});t.push(!0),r.append(l)}t.some(function(e){return e===!0})&&S.removeClass("empty")};r.on("mousemove","li.disabled",function(t){e(".frmb-tt",this).css({left:t.offsetX-16,top:t.offsetY-34})}),r.on("mouseenter","li.disabled",function(){c.disabledTT.add(e(this))}),r.on("mouseleave","li.disabled",function(){c.disabledTT.remove(e(this))});var B=function(e){var t=(new Date).getTime();return e.data("attrs").name+"-"+t},j=function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],a=e.data("attrs")||{},l=a.type||e.attr("type"),s={};s.label=c.htmlEncode(e.attr("label")),s.name=t?B(e):a.name||e.attr("name"),s.role=e.attr("role"),s.required=e.attr("required"),s.maxlength=e.attr("maxlength"),s.toggle=e.attr("toggle"),s.multiple=l.match(/(checkbox-group)/),s.type=l,s.description=void 0!==e.attr("description")?c.htmlEncode(e.attr("description")):"",z(s),S.removeClass("empty")},F=function(e){Y(o.messages.textArea,R(e),e)},H=function(e){var t=e.type||"text";Y(o.messages[t],R(e),e)},P=function(t){t.values&&t.values.length||(t.values=[{selected:!0},{selected:!1}],t.values=t.values.map(function(e,t){return e.label=o.messages.option+" "+(t+1),e.value=c.hyphenCase(e.label),e}));var a="";for(a+=R(t),a+='<div class="form-group field-options">',a+='<label class="false-label">'+o.messages.selectOptions+"</label>",a+='<div class="sortable-options-wrap">',"select"===t.type&&(a+='<div class="allow-multi">',a+='<input type="checkbox" id="multiple_'+d+'" name="multiple"'+(t.multiple?'checked="checked"':"")+">",a+='<label class="multiple" for="multiple_'+d+'">'+o.messages.selectionsMessage+"</label>",a+="</div>"),a+='<ol class="sortable-options">',f=0;f<t.values.length;f++)a+=U(t.name,t.values[f],t.values[f].selected,t.multiple);a+="</ol>";var l=c.markup("a",o.messages.addOption,{className:"add add-opt"});a+=c.markup("div",l,{className:"option-actions"}).outerHTML,a+="</div>",a+="</div>",Y(o.messages.select,a,t),e(".sortable-options").sortable()},z=function(e){var t={select:P,"rich-text":F,textarea:F,"radio-group":P,"checkbox-group":P};e=e||"",t[e.type]?t[e.type](e):H(e)},R=function K(t){var a,K=[],l=void 0!==t.role?t.role.split(","):[],s=c.markup("label",o.messages.label),n=c.markup("input",null,{type:"text",name:"label",value:t.label,className:"fld-label form-control"}),i=c.markup("div",[s,n],{className:"form-group label-wrap"});if(K.push(i.outerHTML),t.size=t.size||"m",t.style=t.style||"default","button"!==t.type){var r=c.markup("label",o.messages.description,{"for":"description-"+d}),p=c.markup("input",null,{type:"text",className:"fld-description form-control",name:"description",id:"description-"+d,value:t.description}),u=c.markup("div",[r,p],{"class":"form-group description-wrap"});K.push(u.outerHTML)}K.push(X(t.type)),K.push(_(t.style,t.type)),K.push(W("placeholder",t.type)),K.push(W("className")),K.push('<div class="form-group name-wrap"><label>'+o.messages.name+' <span class="required">*</span></label>'),K.push('<input type="text" name="name" value="'+t.name+'" class="fld-name form-control" id="title-'+d+'" /></div>'),K.push('<div class="form-group access-wrap"><label>'+o.messages.roles+"</label>"),K.push('<input type="checkbox" name="enable_roles" value="" '+(void 0!==t.role?"checked":"")+' id="enable_roles-'+d+'"/> <label for="enable_roles-'+d+'" class="roles-label">'+o.messages.limitRole+"</label>"),K.push('<div class="available-roles" '+(void 0!==t.role?'style="display:block"':"")+">");for(a in o.roles)-1===e.inArray(a,["date","4"])&&K.push('<input type="checkbox" name="roles[]" value="'+a+'" id="fld-'+d+"-roles-"+a+'" '+(-1!==e.inArray(a,l)?"checked":"")+' class="roles-field" /><label for="fld-'+d+"-roles-"+a+'">'+o.roles[a]+"</label><br/>");return K.push("</div></div>"),e.inArray(t.type,["checkbox","select","checkbox-group","date","autocomplete","radio-group","hidden","button"])<0&&(K.push('<div class="form-group"><label class="maxlength-label">'+o.messages.maxlength+"</label>"),K.push('<input type="text" name="maxlength" maxlength="4" value="'+(void 0!==t.maxlength?t.maxlength:"")+'" class="fld-maxlength form-control" id="maxlength-'+d+'" /></div>')),K.join("")},X=function(e){var t=o.messages.subtypes,a="";if(t[e]){var l="<label>"+o.messages.subtype+"</label>";a+='<select name="subtype" class="fld-subtype form-control" id="subtype-'+d+'">',t[e].forEach(function(t){var l=e===t?"selected":"";a+='<option value="'+t+'" '+l+">"+t+"</option>"}),a+="</select>",a='<div class="form-group subtype-wrap">'+l+" "+a+"</div>"}return a},_=function(e,t){var a={button:"btn"},l=o.messages.styles[a[t]],s="";if(l){var n="<label>"+o.messages.style+"</label>";s+='<input value="'+e+'" name="style" type="hidden" class="btn-style">',s+='<div class="btn-group" role="group">',Object.keys(o.messages.styles[a[t]]).forEach(function(l){var n=e===l?"active":"";s+='<button value="'+l+'" type="'+t+'" class="'+n+" btn-xs "+a[t]+" "+a[t]+"-"+l+'">'+o.messages.styles[a[t]][l]+"</button>"}),s+="</div>",s='<div class="form-group style-wrap">'+n+" "+s+"</div>"}return s},W=function(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1],a=["text","textarea","select"],l=o.messages.placeholders,s=l[e]||"",n="",i=[];"placeholder"===e&&-1===a.indexOf(t)&&i.push(!0);var r=i.some(function(e){return e===!0});if(!r){var c="<label>"+o.messages[e]+"</label>";n+='<input type="text" name="'+e+'" placeholder="'+s+'" class="fld-'+e+' form-control" id="'+e+"-"+d+'">',n='<div class="form-group '+e+'-wrap">'+c+" "+n+"</div>"}return n},Y=function(t,a,l){var s=e(a).find('input[name="label"]').val(),n=s?s:t,i=c.markup("a",o.messages.remove,{id:"del_"+d,className:"del-button btn delete-confirm",title:o.messages.removeMessage}),p=c.markup("a",null,{id:"frm-"+d,className:"toggle-form btn icon-pencil",title:o.messages.hide}),u=c.markup("div",[p,i],{className:"field-actions"}).outerHTML,m=l.required,f=l.toggle||void 0,v=""!==l.description?'<span class="tooltip-element" tooltip="'+l.description+'">?</span>':"",g=u;g+='<label class="field-label">'+n+"</label>"+v+'<span class="required-asterisk" '+("true"===m?'style="display:inline"':"")+"> *</span>",g+=c.markup("div","",{className:"prev-holder"}).outerHTML,g+='<div id="frm-'+d+'-fld" class="frm-holder">',g+='<div class="form-elements">',g+='<div class="form-group">',g+="<label>&nbsp;</label>";var h=c.markup("input",null,{className:"required",type:"checkbox",name:"required-"+d,id:"required-"+d,value:1});h.defaultChecked="true"===m,g+=h.outerHTML,g+=c.markup("label",o.messages.required,{className:"required-label","for":"required-"+d}).outerHTML,g+="</div>","checkbox"===l.type&&(g+='<div class="form-group">',g+="<label>&nbsp;</label>",g+='<input class="checkbox-toggle" type="checkbox" value="1" name="toggle-'+d+'" id="toggle-'+d+'"'+("true"===f?" checked":"")+' /><label class="toggle-label" for="toggle-'+d+'">'+o.messages.toggle+"</label>",g+="</div>"),g+=a,g+=c.markup("a",o.messages.close,{className:"close-field"}).outerHTML,g+="</div>",g+="</div>";var b=c.markup("li",g,{"class":l.type+"-field form-field",id:"frm-"+d+"-item"}),y=e(b);y.data("fieldData",{attrs:l}),"undefined"!=typeof c.stopIndex?e("> li",r).eq(c.stopIndex).after(y):r.append(y),c.updatePreview(y),e(document.getElementById("frm-"+d+"-item")).hide().slideDown(250),d++},U=function(e,t,a,l){var s={selected:l?"checkbox":"radio"},n={selected:a,label:"",value:""},i=Object.assign(n,t),r=[];for(var d in i)if(i.hasOwnProperty(d)){var p={type:s[d]||"text","class":"option-"+d,placeholder:o.messages.placeholders[d],value:i[d],name:e},u=c.markup("input",null,p);"selected"===d&&(u.checked=i.selected),r.push(u)}var m={className:"remove btn",title:o.messages.removeMessage};r.push(c.markup("a",o.messages.remove,m));var f=c.markup("li",r);return f.outerHTML};r.on("click touchstart",".remove",function(t){var a=e(this).parents(".form-field:eq(0)");t.preventDefault();var l=e(this).parents(".sortable-options:eq(0)").children("li").length;2>=l?o.notify.error("Error: "+o.messages.minOptionMessage):e(this).parent("li").slideUp("250",function(){e(this).remove()}),O.call(a)}),r.on("touchstart","input",function(t){if(t.handled===!0)return!1;if("checkbox"===e(this).attr("type"))e(this).trigger("click");else{e(this).focus();var a=e(this).val();e(this).val(a)}}),r.on("click touchstart",".toggle-form",function(t){if(t.stopPropagation(),t.preventDefault(),t.handled===!0)return!1;var a=e(this).attr("id");c.toggleEdit(a+"-item"),t.handled=!0}),c.toggleEdit=function(t){var a=document.getElementById(t),l=e(".toggle-form",a),s=e(".frm-holder",a);l.toggleClass("open"),e(".prev-holder",a).slideToggle(250),s.slideToggle(250)},r.on("keyup change",'input[name="label"]',function(){e(".field-label",e(this).closest("li")).text(e(this).val())}),r.delegate("input.error","keyup",function(){e(this).removeClass("error")}),r.on("keyup",'input[name="description"]',function(){var t=e(this).parents(".form-field:eq(0)"),a=e(".tooltip-element",t),l=e(this).val();if(""!==l)if(a.length)a.attr("tooltip",l).css("display","inline-block");else{var s='<span class="tooltip-element" tooltip="'+l+'">?</span>';e(".field-label",t).after(s)}else a.length&&a.css("display","none")}),c.updateMultipleSelect(),r.delegate('input[name="name"]',"keyup",function(){e(this).val(c.safename(e(this).val())),""===e(this).val()?e(this).addClass("field_error").attr("placeholder",o.messages.cannotBeEmpty):e(this).removeClass("field_error")}),r.delegate("input.fld-maxlength","keyup",function(){e(this).val(c.forceNumber(e(this).val()))}),r.on("click touchstart",".delete-confirm",function(t){t.preventDefault();var a=this.getBoundingClientRect(),l=document.body.getBoundingClientRect(),s={pageX:a.left+a.width/2,pageY:a.top-l.top-12},n=e(this).attr("id").replace(/del_/,""),i=e(document.getElementById("frm-"+n+"-item")),d=function(){i.slideUp(250,function(){i.removeClass("deleting"),i.remove(),c.save()})};if(document.addEventListener("modalClosed",function(){i.removeClass("deleting")},!1),o.fieldRemoveWarn){var p=c.markup("h3",o.messages.warning),u=c.markup("p",o.messages.fieldRemoveWarning);c.confirm([p,u],d,s),i.addClass("deleting")}else d(i);1===e("> li",r).length&&S.addClass("empty").attr("data-content",o.messages.getStarted)}),r.on("click",".style-wrap button",function(){var t=e(this).val(),a=e(this).parent(),l=a.prev(".btn-style");l.val(t),e(this).siblings(".btn").removeClass("active"),e(this).addClass("active"),O.call(a)}),r.on("click","input.required",function(){var t=e(this).parents("li.form-field").find(".required-asterisk");t.toggle()}),r.on("click",'input[name="enable_roles"]',function(){var t=e(this).siblings("div.available-roles"),a=e(this);t.slideToggle(250,function(){a.is(":checked")||e('input[type="checkbox"]',t).removeAttr("checked")})}),r.on("click",".add-opt",function(t){t.preventDefault();var a=e(this).parents(".field-options:eq(0)"),l=e('[name="multiple"]',a),s=e(".option-selected:eq(0)",a),o=!1;o=l.length?l.prop("checked"):"checkbox"===s.attr("type");var n=s.attr("name");e(".sortable-options",a).append(U(n,!1,!1,o)),c.updateMultipleSelect()}),r.on("click touchstart",".close-field",function(){var t=e(this).parents("li.form-field:eq(0)").attr("id");c.toggleEdit(t)}),r.on("mouseover mouseout",".remove, .del-button",function(){e(this).parents("li:eq(0)").toggleClass("delete")});var G=e(document.getElementById(i+"-view-data"));G.click(function(e){e.preventDefault();var t=c.htmlEncode(n.val()),a=c.markup("code",t,{className:"xml"}),l=c.markup("pre",a);c.dialog(l,null,"data-dialog")});var V=e(document.getElementById(i+"-clear-all"));V.click(function(){var t=e("li.form-field"),a=this.getBoundingClientRect(),l=document.body.getBoundingClientRect(),s={pageX:a.left+a.width/2,pageY:a.top-l.top-12};t.length?c.confirm("Are you sure you want to clear all fields?",function(){c.removeAllfields(),o.notify.success(o.messages.allFieldsRemoved),c.save()},s):c.dialog("There are no fields to clear",{pageX:s.pageX,pageY:s.pageY})}),e(document.getElementById(i+"-save")).click(function(e){e.preventDefault(),c.save(),c.validateForm(e)});var J=!1,Q=[],Z="68,69,86";return e(".fb-save").mouseover(function(){J=!0}).mouseout(function(){J=!1}),e(document.documentElement).keydown(function(t){Q.push(t.keyCode),Q.toString().indexOf(Z)>=0&&(e(".action-links").toggle(),e(".view-data").toggle(),Q=[])}),e(".dev-mode-link").click(function(t){t.preventDefault();var a=e(this);S.toggleClass("dev-mode"),a.parent().css("opacity",1),S.hasClass("dev-mode")?(a.siblings(".action-links-inner").css("width","100%"),a.html(o.messages.devMode+" "+o.messages.on).css("color","#8CC63F")):(a.siblings(".action-links-inner").css("width",0),
a.html(o.messages.devMode+" "+o.messages.off).css("color","#666666"),J=!1,e(".action-links").toggle(),e(".view-data").toggle())}),e(document.getElementById(i+"-edit-names")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e(".name-wrap",r).slideToggle(250,function(){S.toggleClass("edit-names")})}),e(document.getElementById(i+"-allow-select")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e(".allow-multi, .option-selected",r).slideToggle(250,function(){S.toggleClass("allow-select")})}),e(document.getElementById(i+"-edit-xml")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e("textarea.idea-template").show(),e(".template-textarea-wrap").slideToggle(250),S.toggleClass("edit-xml")}),n.parent().find('p[id*="ideaTemplate"]').remove(),n.wrap('<div class="template-textarea-wrap"/>'),$(),r.css("min-height",m.height()),document.dispatchEvent(l.events.loaded),l};e.fn.formBuilder=function(a){return this.each(function(){var l,s=this;if(e(s).data("formBuilder")){var o=e(s).parents(".form-builder:eq(0)"),n=e(s).clone();o.before(n),o.remove(),l=new t(a,n[0]),n.data("formBuilder",l)}else l=new t(a,s),e(s).data("formBuilder",l)})}}(jQuery),function(e){e.fn.toXML=function(t){var a={prepend:"",attributes:["class"]},l=e.extend(a,t),s="",o={};o.getType=function(t){var a=e(".fld-subtype",t).val()||t.attr("class").replace("-field form-field","");return a},o.hyphenCase=function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},o.attrString=function(e){var t=[];for(var a in e)if(e.hasOwnProperty(a)&&e[a]){var l=a+'="'+e[a]+'"';t.push(l)}return t.join(" ")};var n=function(t){var a=[];return e(".sortable-options li",t).each(function(){var t=e(this),l='value="'+e(".option-value",t).val()+'"',s=e(".option-label",t).val(),o=e(".option-selected",t).is(":checked")?' selected="true"':"";a.push("\n			<option"+o+" "+l+">"+s+"</option>")}),a.join("")};return this.each(function(){e(this).children().length>=1&&(s+="<form-template>\n	<fields>",e(this).children().each(function(){var t=e(this),a=t.data("fieldData");if(!t.hasClass("moving")&&!t.hasClass("disabled"))for(var i=0;i<l.attributes.length;i++){var r=e.map(e("input.roles-field:checked",t),function(e){return e.value}).join(","),c={className:a.className,description:e("input.fld-description",t).val(),label:e("input.fld-label",t).val(),maxlength:e("input.fld-maxlength",t).val(),multiple:e('input[name="multiple"]',t).is(":checked"),name:e("input.fld-name",t).val(),placeholder:e("input.fld-placeholder",t).val(),required:e("input.required",t).is(":checked"),role:r,toggle:e(".checkbox-toggle",t).is(":checked"),type:o.getType(t)},d=c.type.match(/(select|checkbox-group|radio-group)/),p=o.attrString(c),u=d?"":"/";s+="\n		<field "+p+u+">",d&&(s+=n(t),s+="\n		</field>")}}),s+="\n	</fields>\n</form-template>")}),s}}(jQuery),"function"!=typeof Object.assign&&!function(){var e=arguments;Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(t),l=1;l<e.length;l++){var s=e[l];if(void 0!==s&&null!==s)for(var o in s)s.hasOwnProperty(o)&&(a[o]=s[o])}return a}}(),"function"!=typeof Element.remove&&!function(){var e=this;Element.prototype.remove=function(){e.parentElement.removeChild(e)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=this.length-1;e>=0;e--)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])}}(),"function"!=typeof Event&&!function(){Event=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}}();